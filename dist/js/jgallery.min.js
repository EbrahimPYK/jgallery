/*!
* jgallery v1.5.2
* http://jgallery.jakubkowalczyk.pl/
*
* Released under the MIT license
*
* Date: 2015-02-24
*/
!function(a){"use strict";a.module("jgallery",[]);var b={autostart:!0,autostartAtImage:1,autostartAtAlbum:1,backgroundColor:"#fff",backgroundColorAlternative:"#ddd",browserHistory:!0,canChangeMode:!0,canClose:!1,canMinimalizeThumbnails:!0,canZoom:!0,disabledOnIE8AndOlder:!0,draggableZoom:!0,draggableZoomHideNavigationOnMobile:!0,height:"100vh",hideThumbnailsOnInit:!1,maxMobileWidth:767,mode:"standard",preloadAll:!1,slideshow:!0,slideshowAutostart:!1,slideshowCanRandom:!0,slideshowInterval:"8s",slideshowRandom:!1,swipeEvents:!0,textColor:"#000",thumbnails:!0,thumbHeight:75,thumbHeightOnFullScreen:100,thumbnailsFullScreen:!0,thumbnailsHideOnMobile:!0,thumbnailsPosition:"bottom",thumbType:"images",thumbWidth:75,thumbWidthOnFullScreen:100,title:!0,titleExpanded:!1,tooltipClose:"Close",tooltipFullScreen:"Full screen",tooltipRandom:"Random",tooltips:!0,tooltipSeeAllPhotos:"See all photos",tooltipSeeOtherAlbums:"See other albums",tooltipSlideshow:"Slideshow",tooltipToggleThumbnails:"Toggle thumbnails",tooltipZoom:"Zoom",transition:"moveToLeft_moveFromRight",transitionBackward:"auto",transitionCols:1,transitionDuration:"0.7s",transitionRows:1,transitionTimingFunction:"cubic-bezier(0,1,1,1)",transitionWaveDirection:"forward",width:"100%",zoomSize:"fit",afterLoadPhoto:function(){},beforeLoadPhoto:function(){},closeGallery:function(){},initGallery:function(){},showGallery:function(){},showPhoto:function(){}},c={},d={width:"940px",height:"360px",canZoom:!1,draggableZoom:!1,browserHistory:!1,thumbnailsFullScreen:!1,thumbType:"square",thumbWidth:20,thumbHeight:20,canMinimalizeThumbnails:!1,transition:"rotateCubeRightOut_rotateCubeRightIn",transitionBackward:"rotateCubeRightOut_rotateCubeRightIn",transitionCols:6,transitionRows:1,slideshow:!0,slideshowAutostart:!0,zoomSize:"fill"},e={},f={autostart:!0,canClose:!1,zoomSize:"fill",canChangeMode:!1};a.module("jgallery").run(["$templateCache",function(a){a.put("../../templates/jgallery.html",'<div ng-transclude ng-hide="options.mode !== \'full-screen\' && isVisible"></div><div class="jgallery jgallery-{{ options.mode }}" data-jgallery-id="{{ id }}" ng-show=isVisible ng-style="{\r\n        background: options.backgroundColor,\r\n        color: options.textColor,\r\n'+"        'text-shadow': '0 0 1px ' + options.backgroundColor,\r\n        width: options.mode != 'full-screen' ? options.width : 'inherit',\r\n        height: options.mode != 'full-screen' ? options.height : 'inherit'\r\n     }\"><div jgallery-thumbnails ng-hide=\"thumbnailsIsHidden && ! thumbnailsIsFullScreen\" class=\"jgallery-thumbnails jgallery-thumbnails-{{ options.thumbnailsPosition }} {{ options.thumbType }}\" style=\"{{ thumbnailsIsVertical ? 'width: ' + thumbWidth : 'height: ' + thumbHeight }}px; background: {{ options.backgroundColor }}\" ng-class=\"{'full-screen': thumbnailsIsFullScreen}\"></div><div data-jgallery-preview></div></div>"),a.put("../../templates/preview.html","<div class=zoom-container ng-style=\"{\r\n        'left': ! isSlider && ! thumbnailsIsHidden && options.thumbnailsPosition === 'left' ? thumbnails.clientWidth + 'px' : 0,\r\n        'right': ! isSlider && ! thumbnailsIsHidden && options.thumbnailsPosition == 'right' ? thumbnails.clientWidth + 'px' : 0,\r\n        'top': ! isSlider && ! thumbnailsIsHidden && options.thumbnailsPosition == 'top' ? thumbnails.clientHeight + 'px' : 0,\r\n        'bottom': ! isSlider && ! thumbnailsIsHidden && options.thumbnailsPosition == 'bottom' ? 40 + thumbnails.clientHeight + 'px' : '40px',\r\n        'background': options.backgroundColorAlternative\r\n"+'    }"><div class="zoom before pt-perspective"><img ng-src="{{ activePhoto.href }}" ng-style=activePhoto.style></div><div class="drag-nav hide"></div><span class="fa fa-chevron-left prev jgallery-btn jgallery-btn-large" ng-class="{hidden: ! hasPrevPhoto}" ng-click=goToPrevPhoto()></span> <span class="fa fa-chevron-right next jgallery-btn jgallery-btn-large" ng-class="{hidden: ! hasNextPhoto}" ng-click=goToNextPhoto()></span> <span class=progress></span><div class=nav><span jgallery-btn class="fa resize fa-search jgallery-btn jgallery-btn-small" data-tooltip-position="bottom right" data-tooltip="{{ options.tooltipZoom }}" ng-class="{\r\n                \'fa-search-plus\': options.zoomSize == \'fit\' \r\n              }" ng-click=changeZoomSize()></span> <span jgallery-btn class="fa change-mode jgallery-btn jgallery-btn-small" data-tooltip-position="bottom right" data-tooltip="{{ options.tooltipFullScreen }}" ng-show=options.canChangeMode ng-click="options.mode = options.mode == \'standard\' ? \'full-screen\' : \'standard\'" ng-class="{\'fa-expand\': options.mode == \'standard\', \'fa-compress\': options.mode != \'standard\'}"></span> <span jgallery-btn class="fa fa-times jgallery-close jgallery-btn jgallery-btn-small" data-tooltip-position="bottom right" data-tooltip="{{ options.tooltipClose }}" ng-show=options.canClose ng-click="isVisible = false"></span></div><div class=nav-bottom style="background: {{ options.backgroundColor }}; box-shadow: 0 0 5px rgba( 0, 0, 0, .3 )" ng-hide=thumbnailsIsFullScreen><div class=icons><span jgallery-btn class="fa fa-th full-screen jgallery-btn jgallery-btn-small" data-tooltip="{{ options.tooltipSeeAllPhotos }}" ng-click="thumbnailsIsFullScreen = ! thumbnailsIsFullScreen"></span> <span jgallery-btn class="fa minimalize-thumbnails jgallery-btn jgallery-btn-small" data-tooltip="{{ options.tooltipToggleThumbnails }}" ng-class="{\'fa-ellipsis-h\': !thumbnailsIsVertical, \'fa-ellipsis-v\': thumbnailsIsVertical, inactive: thumbnailsIsHidden}" ng-click="thumbnailsIsHidden = ! thumbnailsIsHidden;"></span> <span jgallery-btn class="fa fa-list-ul change-album jgallery-btn jgallery-btn-small" ng-class="{inactive: ! hasManyAlbums, active: albumsDropdownIsVisible}" ng-click="albumsDropdownIsVisible = ! albumsDropdownIsVisible" tooltip="{{ options.tooltipSeeOtherAlbums }}"><span class="menu jgallery-btn" style="background: {{ options.backgroundColor }}; box-shadow: 0 0 20px {{ options.color }}"><span class=item ng-repeat="album in albums" ng-click="setAlbumAsActive( album.id )">{{ album.title }}</span></span> <span class=title>{{ activeAlbum.title }}</span></span></div><div class="title before"></div></div></div>'),a.put("../../templates/scrollable.html",'<div ng-transclude></div><span class="jgallery-scroll-top jgallery-btn" ng-class="{\'visible\': thumbnailsCanScrollTop()}" ng-click=thumbnailsScrollTop();><span class="fa fa-chevron-up ico"></span></span> <span class="jgallery-scroll-bottom jgallery-btn" ng-class="{\'visible\': thumbnailsCanScrollBottom()}" ng-click=thumbnailsScrollBottom();><span class="fa fa-chevron-down ico"></span></span> <span class="jgallery-scroll-left jgallery-btn" ng-class="{\'visible\': thumbnailsCanScrollLeft()}" ng-click=thumbnailsScrollLeft();><span class="fa fa-chevron-left ico"></span></span> <span class="jgallery-scroll-right jgallery-btn" ng-class="{\'visible\': thumbnailsCanScrollRight()}" ng-click=thumbnailsScrollRight();><span class="fa fa-chevron-right ico"></span></span>'),a.put("../../templates/thumbnails.html",'<div jgallery-scrollable><div ng-repeat="album in albums" class=album ng-class="{\'active\': album.id == activeAlbum.id}" style="{{ thumbnailsIsVertical ? \'\' : \'width: \' + album.photos.length * thumbWidth + \'px\' }}"><a ng-repeat="photo in album.photos" ng-click="$event.preventDefault(); $parent.$parent.$parent.$parent.showPhoto( photo ); $parent.$parent.$parent.$parent.thumbnailsIsFullScreen = false;" ng-href="{{ isSlider ? photo.src : photo.href }}" ng-attr-link="{{ isSlider ? photo.href : undefined }}" ng-attr-target="{{ isSlider ? photo.target : undefined }}" style="width: {{ thumbWidth }}px; height: {{ thumbHeight }}px; font-size: {{ thumbHeight }}px"><img ng-src="{{ photo.src }}" ng-attr-alt="{{ photo.title }}" ng-attr-data-jgallery-bg-color="{{ photo.bgColor }}" ng-attr-data-jgallery-text-color="{{ photo.textColor }}" ng-class="{\r\n                     \'thumb-vertical\': photo.thumbWidth / photo.thumbHeight < options.thumbWidth / options.thumbHeight,\r\n                     \'thumb-horizontal\': photo.thumbWidth / photo.thumbHeight >= options.thumbWidth / options.thumbHeight,\r\n                     \'thumb-on-full-screen-vertical\': photo.thumbWidth / photo.thumbHeight < options.thumbWidthOnFullScreen / options.thumbHeightOnFullScreen,\r\n                     \'thumb-on-full-screen-horizontal\': photo.thumbWidth / photo.thumbHeight >= options.thumbWidthOnFullScreen / options.thumbHeightOnFullScreen\r\n                 }"></a></div></div>')}]),function(a){var b=1;a.module("jgallery").directive("jgalleryAlbum",["$compile",function(){return{scope:{},require:"^jgallery",link:function(a,b,c,d){a.album.title=c.jgalleryAlbum,d.addAlbum(a.album)},controller:["$scope",function(a){a.album={id:b++};var c=a.album.photos=[];this.addPhoto=function(b){a.$parent.$apply(function(){c.push(b)})}}]}}])}(a),a.module("jgallery").directive("jgalleryBtn",function(){return{require:"^jgallery",link:function(){}}}),function(a,b,c,d,e,f,g){var h=1;b.module("jgallery").directive("jgallery",["$timeout","$filter",function(i,j){return{transclude:!0,scope:!0,link:function(i,k,l){var m,n=i.id=h++;window.scope=i;var o=function(){i.options=m=b.copy(c);try{var a=b.fromJson(l.jgallery);"full-screen"===a.mode?b.extend(m,d,a,e):"slider"===a.mode?b.extend(m,f,a,g):b.extend(m,a)}catch(h){}},p=function(){return i.activePhoto&&i.activePhoto.id};i.setAlbumAsActive=function(a){i.activeAlbum=j("filter")(i.albums,{id:a})[0],i.showPhoto(i.activeAlbum.photos[0])},i.showPhoto=function(a){i.activePhoto=b.extend({},i.activePhoto,a),i.isVisible=!0},i.goToPrevPhoto=function(){var a;b.forEach(i.activeAlbum.photos,function(b,c){b.id===i.activePhoto.id&&i.activeAlbum.photos[c-1]&&(a=c-1)}),b.isDefined(a)&&i.showPhoto(i.activeAlbum.photos[a])},i.goToNextPhoto=function(){var a;b.forEach(i.activeAlbum.photos,function(b,c){b.id===i.activePhoto.id&&i.activeAlbum.photos[c+1]&&(a=c+1)}),a&&i.showPhoto(i.activeAlbum.photos[a])},b.element(k).attr("data-jgallery-id",n),o(),m.autostart&&(i.isVisible=!0),i.$watch("albums",function(a){i.hasManyAlbums=a.length>1}),i.$watch("options.autostartAtAlbum + albums",function(){i.activeAlbum||(i.activeAlbum=i.albums[m.autostartAtAlbum-1])}),i.$watch("options.autostartAtImage + activeAlbum.photos",function(){!p()&&i.activeAlbum.photos[m.autostartAtImage-1]&&i.showPhoto(i.activeAlbum.photos[m.autostartAtImage-1])}),i.$watch("options.mode",function(a){i.isSlider="slider"===a}),b.element(a.getElementsByTagName("head")).append('<style type="text/css" class="colours" data-jgallery-id="'+n+'"></style>')},controller:["$scope",function(a){var b=a.albums=[];this.addAlbum=function(a){a.title||(a.title="Album "+a.id),b.push(a)},this.showPhoto=function(b){a.showPhoto(b),i(function(){a.$apply()})}}],templateUrl:"../../templates/jgallery.html"}}])}(document,a,b,c,e,d,f),function(a){var b=1;a.module("jgallery").directive("jgalleryPhoto",function(){return{scope:{},require:["^jgalleryAlbum","^jgallery"],link:function(c,d,e,f){var g,h={},i=f[0],j=f[1];d.attr("href")?(g=a.element(d).find("img"),h.href=d.attr("href"),h.target=d.attr("target")):d.attr("src")&&(g=d),h.src=g.attr("src"),h.title=g.attr("alt"),h.bgColor=g.attr("data-jgallery-bg-color"),h.textColor=g.attr("data-jgallery-text-color"),function(){var a=new Image,c=new Image;a.onload=function(){h.thumbWidth=a.width,h.thumbHeight=a.height,h.id=b++,i.addPhoto(h),c.onload=function(){h.width=c.width,h.height=c.height},c.src=h.href},a.src=h.src}(),a.element(d).bind("click",function(a){a.preventDefault(),j.showPhoto(h)})}}})}(a),a.module("jgallery").directive("jgalleryPreview",["$window","$timeout",function(b,c){return{require:"^jgallery",link:function(b,d){var e=b.options;b.preview=d[0].childNodes[0],b.changeZoomSize=function(){if("fit"===e.zoomSize)e.zoomSize="fill";else if("fill"===e.zoomSize){var a=b.activePhoto,c=b.preview;console.log(c.clientWidth,a.width,c.clientHeight,a.height),e.zoomSize=c.clientWidth===a.width||c.clientHeight===a.height?"fit":"original"}else e.zoomSize="fit"},b.$watch("options.zoomSize",function(a){try{b.activePhoto.style}catch(c){b.activePhoto={style:{}}}"fill"===a?(b.activePhoto.style["min-width"]="100%",b.activePhoto.style["min-height"]="100%",b.activePhoto.style["max-width"]="none",b.activePhoto.style["max-height"]="none"):"fit"===a?(b.activePhoto.style["min-width"]="0",b.activePhoto.style["min-height"]="0",b.activePhoto.style["max-width"]="100%",b.activePhoto.style["max-height"]="100%"):(b.activePhoto.style["min-width"]="0",b.activePhoto.style["min-height"]="0",b.activePhoto.style["max-width"]="none",b.activePhoto.style["max-height"]="none")}),b.$watchGroup(["activePhoto","activePhoto + activeAlbum.photos"],function(){a.forEach(b.albums,function(c){a.forEach(c.photos,function(a,d){a.id===b.activePhoto.id&&(b.hasPrevPhoto=d>0,b.hasNextPhoto=d<c.photos.length-1)})})}),b.$watch("thumbnailsIsHidden + thumbnailsIsFullScreen",function(){b.thumbnailsIsHidden&&b.thumbnailsIsFullScreen||c(function(){b.$apply()})})},templateUrl:"../../templates/preview.html"}}]),a.module("jgallery").directive("jgalleryScrollable",["$interval","$window",function(a,b){return{transclude:!0,scope:!0,link:function(c,d){var e=b.container=d[0].childNodes[0],f=function(a,b,c){h(a,b,c,"scrollTop")},g=function(a,b,c){h(a,b,c,"scrollLeft")},h=function(b,c,d,e){var f=40,g=b[e],h=d/f,i=(c-g)/h,j=0,k=a(function(){j++,b[e]+=i,j===h&&a.cancel(k)},f)};c.thumbnailsCanScrollTop=function(){return e.scrollTop>0},c.thumbnailsScrollTop=function(){c.thumbnailsCanScrollTop()&&f(e,e.scrollTop-.7*b.innerHeight,200)},c.thumbnailsCanScrollBottom=function(){return e.offsetHeight+e.scrollTop<e.scrollHeight},c.thumbnailsScrollBottom=function(){c.thumbnailsCanScrollBottom()&&f(e,e.scrollTop+.7*b.innerHeight,200)},c.thumbnailsCanScrollLeft=function(){return e.scrollLeft>0},c.thumbnailsScrollLeft=function(){c.thumbnailsCanScrollLeft()&&g(e,e.scrollLeft-.7*b.innerWidth,200)},c.thumbnailsCanScrollRight=function(){return e.offsetWidth+e.scrollLeft<e.scrollWidth},c.thumbnailsScrollRight=function(){c.thumbnailsCanScrollRight()&&g(e,e.scrollLeft+.7*b.innerWidth,200)}},templateUrl:"../../templates/scrollable.html"}}]),function(a,b){b.module("jgallery").directive("jgalleryThumbnails",function(){return{require:"^jgallery",link:function(a,b){a.$watch("options.thumbnailsPosition",function(b){a.thumbnailsIsVertical="left"===b||"right"===b}),a.$watch("options.thumbnailsFullScreen",function(b){b?(a.thumbWidth=a.options.thumbWidthOnFullScreen,a.thumbHeight=a.options.thumbHeightOnFullScreen):(a.thumbWidth=a.options.thumbWidth,a.thumbHeight=a.options.thumbHeight)}),a.thumbnails=b[0],a.thumbnailsFullScreen=!1},templateUrl:"../../templates/thumbnails.html"}})}(window,a,b,c,e,d,f)}(angular);