/*!
* jgallery v2.0.0
* http://jgallery.jakubkowalczyk.pl/
*
* Released under the MIT license
*
* Date: 2015-05-28
*/
!function(a){"use strict";a.module("jgallery",[]),a.module("jgallery").factory("defaults",function(){return{autostart:!0,autostartAtImage:1,autostartAtAlbum:1,backgroundColor:"#fff",backgroundColorAlternative:"#ddd",browserHistory:!0,canChangeMode:!0,canClose:!1,canMinimalizeThumbnails:!0,canZoom:!0,disabledOnIE8AndOlder:!0,draggableZoom:!0,draggableZoomHideNavigationOnMobile:!0,height:"100vh",hideThumbnailsOnInit:!1,maxMobileWidth:767,mode:"standard",preloadAll:!1,slideshow:!0,slideshowAutostart:!1,slideshowCanRandom:!0,slideshowInterval:"8s",slideshowRandom:!1,swipeEvents:!0,textColor:"#000",thumbnails:!0,thumbHeight:75,thumbHeightOnFullScreen:100,thumbnailsFullScreen:!0,thumbnailsHideOnMobile:!0,thumbnailsPosition:"bottom",thumbType:"images",thumbWidth:75,thumbWidthOnFullScreen:100,title:!0,titleExpanded:!1,tooltipClose:"Close",tooltipFullScreen:"Full screen",tooltipRandom:"Random",tooltips:!0,tooltipSeeAllPhotos:"See all photos",tooltipSeeOtherAlbums:"See other albums",tooltipSlideshow:"Slideshow",tooltipToggleThumbnails:"Toggle thumbnails",tooltipZoom:"Zoom",transition:"moveToLeft_moveFromRight",transitionBackward:"auto",transitionCols:1,transitionDuration:"0.7s",transitionRows:1,transitionTimingFunction:"cubic-bezier(0,1,1,1)",transitionWaveDirection:"forward",width:"100%",zoomSize:"fit",afterLoadPhoto:function(){},beforeLoadPhoto:function(){},closeGallery:function(){},initGallery:function(){},showGallery:function(){},showPhoto:function(){}}}),a.module("jgallery").factory("defaultsFullScreenMode",function(){return{}}),a.module("jgallery").factory("defaultsSliderMode",function(){return{width:"940px",height:"360px",canZoom:!1,draggableZoom:!1,browserHistory:!1,thumbnailsFullScreen:!1,thumbType:"square",thumbWidth:20,thumbHeight:20,canMinimalizeThumbnails:!1,transition:"rotateCubeRightOut_rotateCubeRightIn",transitionBackward:"rotateCubeRightOut_rotateCubeRightIn",transitionCols:6,transitionRows:1,slideshow:!0,slideshowAutostart:!0,zoomSize:"fill"}}),a.module("jgallery").factory("requiredFullScreenMode",function(){return{}}),a.module("jgallery").factory("requiredSliderMode",function(){return{autostart:!0,canClose:!1,zoomSize:"fill",canChangeMode:!1}}),a.module("jgallery").run(["$templateCache",function(a){a.put("../../templates/animation.html",'<div class=jgallery-animation-container><div ng-repeat="row in rows" class=row><div ng-repeat="col in cols" class=item><div ng-transclude></div></div></div></div>'),a.put("../../templates/draggable-nav.html","<div class=zoom-nav ng-class=\"{hide: ! draggableNavIsVisible && ! draggingInProgress}\"><img jgallery-draggable-img ng-src=\"{{ activePhoto.href }}\" class=bg><div jgallery-draggable-nav-crop class=crop ng-style=\"{\r\n        width: preview.clientWidth / img.width * nav.width  + 'px',\r\n        height: preview.clientHeight / img.height * nav.height  + 'px',\r\n        'margin-left': - parseInt( img.style.marginLeft ) / img.width * nav.width + 'px',\r\n        'margin-top': - img.height / img.height * parseInt( img.style.marginTop ) / img.height * nav.height + 'px',\r\n        'border-color': options.backgroundColor\r\n    }\"><img ng-src=\"{{ activePhoto.href }}\" ng-style=\"{\r\n            'margin-left': parseInt( img.style.marginLeft ) / img.width * nav.width + 'px',\r\n            'margin-top': img.height / img.height * parseInt( img.style.marginTop ) / img.height * nav.height + 'px',\r\n        }\"></div></div>"),a.put("../../templates/jgallery.html",'<div ng-transclude ng-hide="options.mode !== \'full-screen\' && isVisible"></div><div class="jgallery jgallery-{{ options.mode }}" data-jgallery-id="{{ id }}" ng-show=isVisible ng-style="{\n        background: options.backgroundColor,\n        color: options.textColor,\n'+"        'text-shadow': '0 0 1px ' + options.backgroundColor,\n        width: options.mode != 'full-screen' ? options.width : 'inherit',\n        height: options.mode != 'full-screen' ? options.height : 'inherit'\n     }\"><div jgallery-thumbnails ng-hide=\"thumbnailsIsHidden && ! thumbnailsIsFullScreen\" class=\"jgallery-thumbnails jgallery-thumbnails-{{ options.thumbnailsPosition }} {{ options.thumbType }}\" style=\"{{ thumbnailsIsVertical ? 'width: ' + thumbWidth : 'height: ' + thumbHeight }}px; background: {{ options.backgroundColor }}\" ng-class=\"{'full-screen': thumbnailsIsFullScreen}\"></div><div data-jgallery-preview></div></div>"),a.put("../../templates/preview.html","<div class=zoom-container ng-style=\"{\n        'left': ! isSlider && ! thumbnailsIsHidden && options.thumbnailsPosition === 'left' ? thumbnails.clientWidth + 'px' : 0,\n        'right': ! isSlider && ! thumbnailsIsHidden && options.thumbnailsPosition == 'right' ? thumbnails.clientWidth + 'px' : 0,\n        'top': ! isSlider && ! thumbnailsIsHidden && options.thumbnailsPosition == 'top' ? thumbnails.clientHeight + 'px' : 0,\n        'bottom': ! isSlider && ! thumbnailsIsHidden && options.thumbnailsPosition == 'bottom' ? 40 + thumbnails.clientHeight + 'px' : '40px',\n        'background': options.backgroundColorAlternative\n"+'    }"><div class="zoom before pt-perspective" jgallery-draggable-container><jgallery-animation rows=2 cols=2><img ng-src="{{ activePhoto.href }}" ng-style=activePhoto.style jgallery-draggable-element="{{ canDrag }}" jgallery-draggable-element-on-start=startDragCallback() jgallery-draggable-element-on-stop=stopDragCallback() jgallery-mousedown-prevent-default></jgallery-animation><div jgallery-draggable-nav></div></div><span class="fa fa-chevron-left prev jgallery-btn jgallery-btn-large" ng-class="{hidden: ! hasPrevPhoto}" ng-click=goToPrevPhoto() ng-style="{\n                \'background\': options.backgroundColor\n          }"></span> <span class="fa fa-chevron-right next jgallery-btn jgallery-btn-large" ng-class="{hidden: ! hasNextPhoto}" ng-click=goToNextPhoto() ng-style="{\n                \'background\': options.backgroundColor\n          }"></span> <span class=progress></span><div class=nav ng-style="{\n            \'background\': options.backgroundColor\n        }"><span jgallery-btn class="fa resize fa-search jgallery-btn jgallery-btn-small" data-tooltip-position="bottom right" data-tooltip="{{ options.tooltipZoom }}" ng-class="{\n                \'fa-search-plus\': canZoomIn,\n                \'fa-search-minus\': canZoomOut\n              }" ng-click=changeZoomSize()></span> <span jgallery-btn class="fa change-mode jgallery-btn jgallery-btn-small" data-tooltip-position="bottom right" data-tooltip="{{ options.tooltipFullScreen }}" ng-show=options.canChangeMode ng-click="options.mode = options.mode == \'standard\' ? \'full-screen\' : \'standard\'" ng-class="{\'fa-expand\': options.mode == \'standard\', \'fa-compress\': options.mode != \'standard\'}"></span> <span jgallery-btn class="fa fa-times jgallery-close jgallery-btn jgallery-btn-small" data-tooltip-position="bottom right" data-tooltip="{{ options.tooltipClose }}" ng-show=options.canClose ng-click="isVisible = false"></span></div><div class=nav-bottom style="background: {{ options.backgroundColor }}; box-shadow: 0 0 5px rgba( 0, 0, 0, .3 )" ng-hide=thumbnailsIsFullScreen><div class=icons><span jgallery-btn class="fa fa-th full-screen jgallery-btn jgallery-btn-small" data-tooltip="{{ options.tooltipSeeAllPhotos }}" ng-click="thumbnailsIsFullScreen = ! thumbnailsIsFullScreen"></span> <span jgallery-btn class="fa minimalize-thumbnails jgallery-btn jgallery-btn-small" data-tooltip="{{ options.tooltipToggleThumbnails }}" ng-class="{\'fa-ellipsis-h\': !thumbnailsIsVertical, \'fa-ellipsis-v\': thumbnailsIsVertical, inactive: thumbnailsIsHidden}" ng-click="thumbnailsIsHidden = ! thumbnailsIsHidden;"></span> <span jgallery-btn class="fa fa-list-ul change-album jgallery-btn jgallery-btn-small" ng-class="{inactive: ! hasManyAlbums, active: albumsDropdownIsVisible}" ng-click="albumsDropdownIsVisible = ! albumsDropdownIsVisible" tooltip="{{ options.tooltipSeeOtherAlbums }}"><span class="menu jgallery-btn" style="background: {{ options.backgroundColor }}; box-shadow: 0 0 20px {{ options.color }}"><span class=item ng-repeat="album in albums" ng-click="setAlbumAsActive( album.id )">{{ album.title }}</span></span> <span class=title>{{ activeAlbum.title }}</span></span></div><div class="title before"></div></div></div>'),a.put("../../templates/scrollable.html",'<div ng-transclude></div><span class="jgallery-scroll-top jgallery-btn" ng-class="{\'visible\': canScrollTop()}" ng-click=scrollTop();><span class="fa fa-chevron-up ico"></span></span> <span class="jgallery-scroll-bottom jgallery-btn" ng-class="{\'visible\': canScrollBottom()}" ng-click=scrollBottom();><span class="fa fa-chevron-down ico"></span></span> <span class="jgallery-scroll-left jgallery-btn" ng-class="{\'visible\': canScrollLeft()}" ng-click=scrollLeft();><span class="fa fa-chevron-left ico"></span></span> <span class="jgallery-scroll-right jgallery-btn" ng-class="{\'visible\': canScrollRight()}" ng-click=scrollRight();><span class="fa fa-chevron-right ico"></span></span>'),a.put("../../templates/thumbnails.html",'<div jgallery-scrollable><div ng-repeat="album in albums" class=album ng-class="{\'active\': album.id == activeAlbum.id}" style="{{ thumbnailsIsVertical ? \'\' : \'width: \' + album.photos.length * thumbWidth + \'px\' }}"><a ng-repeat="photo in album.photos" ng-click="$event.preventDefault(); $parent.$parent.$parent.$parent.showPhoto( photo ); $parent.$parent.$parent.$parent.thumbnailsIsFullScreen = false;" ng-href="{{ isSlider ? photo.src : photo.href }}" ng-attr-link="{{ isSlider ? photo.href : undefined }}" ng-attr-target="{{ isSlider ? photo.target : undefined }}" style="width: {{ thumbWidth }}px; height: {{ thumbHeight }}px; font-size: {{ thumbHeight }}px"><img ng-src="{{ photo.src }}" ng-attr-alt="{{ photo.title }}" ng-attr-data-jgallery-bg-color="{{ photo.bgColor }}" ng-attr-data-jgallery-text-color="{{ photo.textColor }}" ng-class="{\n                     \'thumb-vertical\': photo.thumbWidth / photo.thumbHeight < options.thumbWidth / options.thumbHeight,\n                     \'thumb-horizontal\': photo.thumbWidth / photo.thumbHeight >= options.thumbWidth / options.thumbHeight,\n                     \'thumb-on-full-screen-vertical\': photo.thumbWidth / photo.thumbHeight < options.thumbWidthOnFullScreen / options.thumbHeightOnFullScreen,\n                     \'thumb-on-full-screen-horizontal\': photo.thumbWidth / photo.thumbHeight >= options.thumbWidthOnFullScreen / options.thumbHeightOnFullScreen\n                 }"></a></div></div>')}]),a.module("jgallery").directive("jgalleryAlbum",function(){var a=1;return{scope:{},require:"^jgallery",link:function(a,b,c,d){a.album.title=c.jgalleryAlbum,d.addAlbum(a.album)},controller:["$scope",function(b){b.album={id:a++};var c=b.album.photos=[];this.addPhoto=function(a){b.$parent.$apply(function(){c.push(a)})}}]}}),a.module("jgallery").directive("jgalleryAnimation",["$timeout",function(){return{scope:{cols:"@",rows:"@"},transclude:!0,templateUrl:"../../templates/animation.html",link:function(a){a.cols=new Array(+a.cols),a.rows=new Array(+a.rows),a.$apply()}}}]),a.module("jgallery").directive("jgalleryDraggableContainer",function(){var a=function(a,b){var c=Math.max(a.left-b.left,0);return c?-c:Math.max(-a.left-a.width+b.left+b.width,0)},b=function(a,b){var c=Math.max(a.top-b.top,0);return c?-c:Math.max(-a.top-a.height+b.top+b.height,0)};return{controller:["$scope","$element",function(c,d){c.$on("jgallery:draggableElement:move",function(a,b){c.$broadcast("jgallery:draggableContainer:change",b)}),this.pullEdge=function(e){var f=e[0].getBoundingClientRect(),g=d[0].getBoundingClientRect();e.css({"margin-top":g.height<f.height?parseInt(e.css("margin-top"))+b(f,g)+"px":"0","margin-left":g.width<f.width?parseInt(e.css("margin-left"))+a(f,g)+"px":"0"}),c.$broadcast("jgallery:draggableContainer:change",e)}}]}}),a.module("jgallery").directive("jgalleryDraggableElement",function(){return{require:"?^jgalleryDraggableContainer",scope:{start:"&jgalleryDraggableElementOnStart",stop:"&jgalleryDraggableElementOnStop"},link:function(b,c,d,e){var f,g,h,i,j=a.element(c),k=function(a){f=a.pageX,g=a.pageY,h=parseInt(j.css("margin-left")),i=parseInt(j.css("margin-top")),j.bind("mousemove",l).bind("mouseup mouseleave",m),b.start()},l=function(a){j.css({"margin-left":h+a.pageX-f+"px","margin-top":i+a.pageY-g+"px"}),b.$emit("jgallery:draggableElement:move",j)},m=function(){e&&e.pullEdge(j),j.unbind("mousemove",l).unbind("mouseup mouseleave",m),b.stop()};d.$observe("jgalleryDraggableElement",function(a){"true"===a?j.bind("mousedown",k):j.unbind("mousedown",k)})}}}),a.module("jgallery").directive("jgalleryDraggableImg",["$timeout",function(){return{require:"^jgalleryDraggableContainer",link:function(a,b){a.nav=b[0]}}}]),a.module("jgallery").directive("jgalleryDraggableNav",["$timeout",function(a){return{require:"^jgalleryDraggableContainer",scope:!0,controller:["$scope","$element",function(b){b.$watch("options.mode",function(){a(function(){b.$apply()})}),b.$on("jgallery:draggableContainer:change",function(a,c){b.img=c[0],b.$apply()})}],templateUrl:"../../templates/draggable-nav.html"}}]),a.module("jgallery").directive("jgallery",["defaults","defaultsFullScreenMode","requiredFullScreenMode","defaultsSliderMode","requiredSliderMode","$timeout","$filter","$document","$window",function(b,c,d,e,f,g,h,i,j){var k=1;return{transclude:!0,scope:!0,link:function(g,l,m){var n,o=g.id=k++;j.scope=g;var p=function(){g.options=n=a.copy(b);try{var h=a.fromJson(m.jgallery);"full-screen"===h.mode?a.extend(n,c,h,d):"slider"===h.mode?a.extend(n,e,h,f):a.extend(n,h)}catch(i){}},q=function(){return g.activePhoto&&g.activePhoto.id};g.setAlbumAsActive=function(a){g.activeAlbum=h("filter")(g.albums,{id:a})[0],g.showPhoto(g.activeAlbum.photos[0])},g.showPhoto=function(a){g.activePhoto=a,g.isVisible=!0},g.goToPrevPhoto=function(){var b;a.forEach(g.activeAlbum.photos,function(a,c){a.id===g.activePhoto.id&&g.activeAlbum.photos[c-1]&&(b=c-1)}),a.isDefined(b)&&g.showPhoto(g.activeAlbum.photos[b])},g.goToNextPhoto=function(){var b;a.forEach(g.activeAlbum.photos,function(a,c){a.id===g.activePhoto.id&&g.activeAlbum.photos[c+1]&&(b=c+1)}),b&&g.showPhoto(g.activeAlbum.photos[b])},a.element(l).attr("data-jgallery-id",o),p(),n.autostart&&(g.isVisible=!0),g.$watch("albums",function(a){g.hasManyAlbums=a.length>1}),g.$watch("options.autostartAtAlbum + albums",function(){g.activeAlbum||(g.activeAlbum=g.albums[n.autostartAtAlbum-1])}),g.$watch("options.autostartAtImage + activeAlbum.photos",function(){!q()&&g.activeAlbum.photos[n.autostartAtImage-1]&&g.showPhoto(g.activeAlbum.photos[n.autostartAtImage-1])}),g.$watch("options.mode",function(a){g.isSlider="slider"===a}),a.element(j).bind("resize",function(){g.$apply()}),a.element(i.find("head")).append('<style type="text/css" class="colours" data-jgallery-id="'+o+'"></style>')},controller:["$scope",function(a){var b=a.albums=[];this.addAlbum=function(a){a.title||(a.title="Album "+a.id),b.push(a)},this.showPhoto=function(b){a.showPhoto(b),g(function(){a.$apply()})}}],templateUrl:"../../templates/jgallery.html"}}]),a.module("jgallery").directive("jgalleryMousedownPreventDefault",function(){return{link:function(b,c){var d=a.element(c);d.bind("mousedown",function(a){a.preventDefault()})}}}),a.module("jgallery").directive("jgalleryPhoto",function(){var b=1;return{require:["^jgalleryAlbum","^jgallery"],link:function(c,d,e,f){var g,h={},i=f[0],j=f[1];d.attr("href")?(g=a.element(d).find("img"),h.href=d.attr("href"),h.target=d.attr("target")):d.attr("src")&&(g=d),h.src=g.attr("src"),h.title=g.attr("alt"),h.bgColor=g.attr("data-jgallery-bg-color"),h.textColor=g.attr("data-jgallery-text-color"),function(){var a=new Image,d=new Image;a.onload=function(){h.thumb=a,h.thumbWidth=a.width,h.thumbHeight=a.height,h.thumbIsVertical=a.thumbWidth<a.thumbHeight,h.id=b++,i.addPhoto(h),d.onload=function(){h.element=d,h.width=d.width,h.height=d.height,h.isVertical=a.width<a.height,c.$apply()},d.src=h.href},a.src=h.src}(),a.element(d).bind("click",function(a){a.preventDefault(),j.showPhoto(h)})}}}),a.module("jgallery").directive("jgalleryPreview",["$timeout",function(b){return{require:"^jgallery",link:function(c,d){var e=c.options,f=c.preview=d[0].childNodes[0];c.parseInt=parseInt,c.changeZoomSize=function(){var a=c.activePhoto;e.zoomSize="fit"===e.zoomSize?"fill":"fill"===e.zoomSize?f.clientWidth===a.width||f.clientHeight===a.height?"fit":"original":"fit"},c.startDragCallback=function(){c.draggingInProgress=!0,c.$apply()},c.stopDragCallback=function(){c.draggingInProgress=!1,c.$apply()},c.$watchGroup(["options.zoomSize","activePhoto.width","activePhoto.height","preview.clientWidth","preview.clientHeight"],function(){var a=c.options.zoomSize,b=c.activePhoto;b&&("fill"===a?(f.clientWidth<b.width&&f.clientHeight<b.height?(c.canZoomIn=!0,c.canZoomOut=!1,c.draggableNavIsVisible=!1):(c.canZoomIn=!1,c.canZoomOut=!0,c.draggableNavIsVisible=!1),c.canDrag=!0):"original"===a&&(f.clientWidth<b.width||f.clientHeight<b.height)?(c.canZoomIn=!1,c.canZoomOut=!0,c.canDrag=!0,c.draggableNavIsVisible=!0):(c.canZoomIn=!0,c.canZoomOut=!1,c.canDrag=!1,c.draggableNavIsVisible=!1))}),c.$watchGroup(["options.zoomSize","activePhoto.width","activePhoto.height","preview.clientWidth","preview.clientHeight"],function(){var b,d,e=c.options.zoomSize;c.activePhoto?c.activePhoto.style||(c.activePhoto.style={}):c.activePhoto={style:{}},b=c.activePhoto,d=b.width/b.height<f.clientWidth/f.clientHeight,"fill"===e?d?a.extend(b.style,{width:"100%",height:"auto","max-width":"none","max-height":"none"}):a.extend(b.style,{width:"auto",height:"100%","max-width":"none","max-height":"none"}):"fit"===e?d?a.extend(b.style,{width:"auto",height:"100%","max-width":"100%","max-height":"none"}):a.extend(b.style,{width:"100%",height:"auto","max-width":"none","max-height":"100%"}):a.extend(b.style,{width:"auto",height:"auto","max-width":"none","max-height":"none"}),a.extend(b.style,{"margin-top":"0","margin-left":"0"})}),c.$watchGroup(["activePhoto","activePhoto + activeAlbum.photos"],function(){a.forEach(c.albums,function(b){a.forEach(b.photos,function(a,d){a.id===c.activePhoto.id&&(c.hasPrevPhoto=d>0,c.hasNextPhoto=d<b.photos.length-1)})})}),c.$watch("thumbnailsIsHidden + thumbnailsIsFullScreen",function(){c.thumbnailsIsHidden&&c.thumbnailsIsFullScreen||b(function(){c.$apply()})})},templateUrl:"../../templates/preview.html"}}]),a.module("jgallery").directive("jgalleryScrollable",["$interval","$window",function(a,b){return{transclude:!0,scope:!0,link:function(c,d){var e=b.container=d[0].childNodes[0],f=function(a,b,c){h(a,b,c,"scrollTop")},g=function(a,b,c){h(a,b,c,"scrollLeft")},h=function(b,c,d,e){var f=40,g=b[e],h=d/f,i=(c-g)/h,j=0,k=a(function(){j++,b[e]+=i,j===h&&a.cancel(k)},f)};c.canScrollTop=function(){return e.scrollTop>0},c.scrollTop=function(){c.canScrollTop()&&f(e,e.scrollTop-.7*b.innerHeight,200)},c.canScrollBottom=function(){return e.offsetHeight+e.scrollTop<e.scrollHeight},c.scrollBottom=function(){c.canScrollBottom()&&f(e,e.scrollTop+.7*b.innerHeight,200)},c.canScrollLeft=function(){return e.scrollLeft>0},c.scrollLeft=function(){c.canScrollLeft()&&g(e,e.scrollLeft-.7*b.innerWidth,200)},c.canScrollRight=function(){return e.offsetWidth+e.scrollLeft<e.scrollWidth},c.scrollRight=function(){c.canScrollRight()&&g(e,e.scrollLeft+.7*b.innerWidth,200)}},templateUrl:"../../templates/scrollable.html"}}]),a.module("jgallery").directive("jgalleryThumbnails",function(){return{require:"^jgallery",link:function(a,b){a.$watch("options.thumbnailsPosition",function(b){a.thumbnailsIsVertical="left"===b||"right"===b}),a.$watch("options.thumbnailsFullScreen",function(b){b?(a.thumbWidth=a.options.thumbWidthOnFullScreen,a.thumbHeight=a.options.thumbHeightOnFullScreen):(a.thumbWidth=a.options.thumbWidth,a.thumbHeight=a.options.thumbHeight)}),a.thumbnails=b[0],a.thumbnailsFullScreen=!1},templateUrl:"../../templates/thumbnails.html"}})}(angular);